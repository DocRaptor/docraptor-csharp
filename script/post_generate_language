#!/bin/bash
set -e
cd "$(dirname "$0")/.."

echo "Removing autogenerated docs..."
rm -r docs

echo "Removing autogenerated tests..."
rm -r src/DocRaptor.Test

echo "Removing trailing whitespace..."
find src -name "*.cs" -type f -exec sed -E -i '' 's/[[:space:]]+$//g' {} +

if compgen -G "patches/*.patch" > /dev/null; then
  echo "Apply patches to generated code"
  git apply --verbose patches/*.patch
fi
